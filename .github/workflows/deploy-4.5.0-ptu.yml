name: Deploy 4.5.0-PTU

on:
  push:
    paths:
      - '.github/workflows/deploy-4.5.0-ptu.yml'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build-and-release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Prepare Release Artifacts
        run: |
          mkdir release_pack
          # Copy Data
          cp -r 4.5.0/PTU/data release_pack/
          # Copy user.cfg
          cp 4.5.0/PTU/user.cfg release_pack/
          
          # Zip it up
          cd release_pack
          zip -r ../ScCompLangPackRemix-4.5.0-PTU.zip data user.cfg
          cd ..
          
          echo "Created zip: ScCompLangPackRemix-4.5.0-PTU.zip"
          unzip -l ScCompLangPackRemix-4.5.0-PTU.zip

      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: 4.5.0-PTU
          name: 4.5.0-PTU
          body: |
            # ScCompLangPackRemix 4.5.0-PTU
            
            **Pre-release for PTU Testing**
            
            This release contains the remixed language pack for Star Citizen 4.5.0 PTU.
            
            ## Installation
            1. Download `ScCompLangPackRemix-4.5.0-PTU.zip`
            2. Extract to your Star Citizen PTU folder (`C:\Program Files\Roberts Space Industries\StarCitizen\PTU`)
            3. Ensure `data` folder and `user.cfg` are in the root of PTU.
          files: ScCompLangPackRemix-4.5.0-PTU.zip
          make_latest: false
          draft: false
          prerelease: true
